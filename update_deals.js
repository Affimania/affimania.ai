const fs = require('fs');
const path = require('path');

// ⚠️ Step 1: Deals Data (Yahan roz naya data aayega)
const realDealsData = [
    {
        title: "Latest Noise Cancelling Earbuds",
        price: Math.floor(Math.random() * 2000) + 1000, 
        mrp: 5000,
        savings: "50% Off",
        affiliate_link: "https://www.amazon.in/s?k=Trending+Earbuds&tag=ascreation00f-21",
        image: "https://example.com/latest_earbuds.jpg"
    },
    {
        title: "Smart Watch for Fitness (New Model)",
        price: Math.floor(Math.random() * 5000) + 2000, 
        mrp: 8999,
        savings: "Flat 45% Discount",
        affiliate_link: "https://www.amazon.in/s?k=Smart+Watch+New&tag=ascreation00f-21",
        image: "https://example.com/smart_watch.jpg"
    }
];

// Step 2: index.html mein data inject karne ka code
const dealsArrayString = JSON.stringify(realDealsData, null, 4);
const indexPath = path.join(__dirname, 'index.html');
let indexContent = fs.readFileSync(indexPath, 'utf8');

const startMarker = '// --- START: AUTOGENERATED DEALS DATA ---';
const endMarker = '// --- END: AUTOGENERATED DEALS DATA ---';

const newDealsCode = `const dummyDeals = ${dealsArrayString};`;

if (indexContent.includes(startMarker) && indexContent.includes(endMarker)) {
    const regex = new RegExp(`(?<=${startMarker}\\n)[\\s\\S]*?(?=\\n${endMarker})`, 'm');
    indexContent = indexContent.replace(regex, newDealsCode);
    console.log('Deals data successfully injected into index.html');
} else {
    console.error('Error: START/END markers not found. Cannot inject deals.');
}

fs.writeFileSync(indexPath, indexContent, 'utf8');
console.log('index.html updated successfully with new deals!');
