const fs = require('fs');
const path = require('path');

const PARTNER_TAG = 'ascreation00f-21';
const buttonLabels = ["Grab This Deal!", "2026 Special Price", "Unlock Offer", "Limited Time Deal", "Check Best Price", "Shop Now"];

function generateCorrectDeals() {
    let finalDeals = [];
    
    // âœ… Sahi Mapping: Naam aur Photo ko ek saath rakha gaya hai
    const realProducts = [
        { name: "Fire-Boltt Phoenix Smartwatch", img: "https://m.media-amazon.com/images/I/61y2VVWlnBL._AC_UL320_.jpg" },
        { name: "boAt Rockerz 450 Headphones", img: "https://m.media-amazon.com/images/I/516LU0H963L._AC_UL320_.jpg" },
        { name: "Echo Dot (5th Gen) Smart Speaker", img: "https://m.media-amazon.com/images/I/61C48I7yfVL._AC_UL320_.jpg" },
        { name: "HP Laptop 15s Ryzen 3", img: "https://m.media-amazon.com/images/I/71-FS7P80NL._AC_UL320_.jpg" },
        { name: "Sony WH-1000XM5 Wireless", img: "https://m.media-amazon.com/images/I/51aBtkSThFL._AC_UL320_.jpg" },
        { name: "OnePlus Nord Buds 2", img: "https://m.media-amazon.com/images/I/61-9mS-7pXL._AC_UL320_.jpg" }, // Fixed Earbuds Image
        { name: "Logitech G502 Gaming Mouse", img: "https://m.media-amazon.com/images/I/71876YcKDRL._AC_UL320_.jpg" },
        { name: "Samsung Galaxy Watch 6", img: "https://m.media-amazon.com/images/I/61f4+n52jHL._AC_UL320_.jpg" }
    ];

    console.log("Generating 40 Accurate Deals...");

    for (let i = 0; i < 40; i++) {
        // Ek ek karke product uthayenge taaki mismatch na ho
        const product = realProducts[i % realProducts.length]; 
        
        const price = Math.floor(Math.random() * 5000) + 1200;
        const mrp = Math.floor(price * 1.5);

        finalDeals.push({
            title: `${product.name} - 2026 Edition`,
            price: price.toLocaleString('en-IN'),
            mrp: mrp.toLocaleString('en-IN'),
            savings: `ðŸ”¥ SAVE ${Math.round(((mrp - price) / mrp) * 100)}% TODAY`,
            affiliate_link: `https://www.amazon.in/s?k=${encodeURIComponent(product.name)}&tag=${PARTNER_TAG}`,
            image: product.img, // Sahi photo hamesha naam ke saath rahegi
            btnText: buttonLabels[i % buttonLabels.length]
        });
    }

    const indexPath = path.join(__dirname, 'index.html');
    let content = fs.readFileSync(indexPath, 'utf8');
    
    const startTag = "// --- START: AUTOGENERATED DEALS DATA ---";
    const endTag = "// --- END: AUTOGENERATED DEALS DATA ---";
    const replaceStr = `${startTag}\nconst dummyDeals = ${JSON.stringify(finalDeals, null, 4)};\n${endTag}`;
    
    content = content.replace(/(\/\/ --- START: AUTOGENERATED DEALS DATA ---)[\s\S]*?(\/\/ --- END: AUTOGENERATED DEALS DATA ---)/, replaceStr);
    
    fs.writeFileSync(indexPath, content);
    console.log('âœ… Success: All product names matched with correct images!');
}

generateCorrectDeals();
