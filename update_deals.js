const fs = require('fs');
const path = require('path');

// ğŸ“¸ Har product ke liye asli images ka database
const imageDatabase = {
    "Winter Jackets": "https://images.unsplash.com/photo-1591047139829-d91aecb6caea?w=500&q=80",
    "Sweaters": "https://images.unsplash.com/photo-1620799140408-edc6dcb6d633?w=500&q=80",
    "Smartwatch": "https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=500&q=80",
    "Wireless Buds": "https://images.unsplash.com/photo-1590658268037-6bf12165a8df?w=500&q=80",
    "Running Shoes": "https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=500&q=80",
    "Backpack": "https://images.unsplash.com/photo-1553062407-98eeb64c6a62?w=500&q=80",
    "Skincare Serum": "https://images.unsplash.com/photo-1620916566398-39f1143f7c6e?w=500&q=80"
};

const seasonalDatabase = {
    winter: {
        badge: "WINTER SPECIAL â„ï¸",
        title: "Crush Your <span class='text-blue-400'>2026 Goals</span>",
        desc: "Best deals on Winter Wear, Fitness Gear, and Health Essentials.",
        bg: "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=1200",
        accent: "#164E63",
        categories: [
            {n: "Winter Wear", i: "ğŸ§¥", l: "winter+wear+jackets"},
            {n: "Fitness", i: "ğŸ‹ï¸â€â™‚ï¸", l: "fitness+equipment"},
            {n: "Gadgets", i: "âŒš", l: "smartwatch"},
            {n: "Health", i: "ğŸ¥—", l: "health+supplements"}
        ]
    }
};

const selectedSeason = seasonalDatabase.winter;
const trendingProducts = Object.keys(imageDatabase); // Image database se hi products uthayega

const realDealsData = [];
for (let i = 1; i <= 99; i++) {
    const price = Math.floor(Math.random() * 8000) + 500;
    const mrp = price + Math.floor(Math.random() * 3000) + 500;
    const randomProduct = trendingProducts[Math.floor(Math.random() * trendingProducts.length)];
    
    realDealsData.push({
        title: `${randomProduct} - Best Offer Today!`,
        price: price,
        mrp: mrp,
        savings: `Flat ${Math.round(((mrp - price) / mrp) * 100)}% Off`,
        affiliate_link: `https://www.amazon.in/s?k=${randomProduct.replace(/\s/g, '+')}&tag=ascreation00f-21`,
        image: imageDatabase[randomProduct] // Placeholder hatakar database se image select hogi
    });
}

const indexPath = path.join(__dirname, 'index.html');
let content = fs.readFileSync(indexPath, 'utf8');

// Injection Logic
content = content.replace(/(\/\/ --- START: AUTOGENERATED DEALS DATA ---)[\s\S]*?(\/\/ --- END: AUTOGENERATED DEALS DATA ---)/, 
    `$1\nconst dummyDeals = ${JSON.stringify(realDealsData, null, 4)};\n$2`);

content = content.replace(/(\/\/ --- START: CONTEXT DATA ---)[\s\S]*?(\/\/ --- END: CONTEXT DATA ---)/, 
    `$1\nconst affimaniaContext = ${JSON.stringify(selectedSeason)};\n$2`);

fs.writeFileSync(indexPath, content);
console.log('âœ… Success: Product images linked to deals!');
