const fs = require('fs');
const path = require('path');

// üîê PA-API KEYS YAHAN DAALEIN (Inhe kisi ko mat dikhana)
const ACCESS_KEY = 'YOUR_ACCESS_KEY_HERE';
const SECRET_KEY = 'YOUR_SECRET_KEY_HERE';
const PARTNER_TAG = 'ascreation00f-21';

// üì∏ Festive High-Res Images for Categories
const imagePool = {
    "Christmas Gift Hampers": [
        "https://images.unsplash.com/photo-1549007994-cb92caebd54b?w=500&q=80",
        "https://images.unsplash.com/photo-1512470876302-972faa2aa9a4?w=500&q=80",
        "https://images.unsplash.com/photo-1513297845702-029bb7a794cc?w=500&q=80"
    ],
    "Party Speakers RGB": [
        "https://images.unsplash.com/photo-1589003077984-894e133dabab?w=500&q=80",
        "https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=500&q=80"
    ],
    "2026 Premium Planners": [
        "https://images.unsplash.com/photo-1506784919141-939e9e033d40?w=500&q=80",
        "https://images.unsplash.com/photo-1531346680769-a1d7ea0993f1?w=500&q=80"
    ],
    "Winter Fashion Jackets": [
        "https://images.unsplash.com/photo-1551488831-00ddcb6c6bd3?w=500&q=80",
        "https://images.unsplash.com/photo-1544022613-e87ca75a784a?w=500&q=80"
    ],
    "Smartwatches": [
        "https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=500&q=80",
        "https://images.unsplash.com/photo-1546868871-70ca1bc0167d?w=500&q=80"
    ]
};

const seasonalDatabase = {
    festive: {
        badge: "HOLIDAY SPECIAL üéÑüéÜ",
        title: "Welcome <span class='text-yellow-400'>2026</span> in Style",
        desc: "Exclusive deals on Christmas Gifts, New Year Party Supplies, and Year-End Clearances.",
        bg: "https://images.unsplash.com/photo-1467810563316-b5476525c0f9?q=80&w=1200",
        accent: "#B30000",
        categories: [
            {n: "Xmas Gifts", i: "üéÅ", l: "christmas+gift+items"},
            {n: "Party Hub", i: "üîä", l: "party+speakers"},
            {n: "2026 Planners", i: "üìÖ", l: "2026+diary+planner"},
            {n: "Fashion", i: "üß•", l: "winter+jackets"}
        ]
    }
};

const trendingProducts = Object.keys(imagePool);
const realDealsData = [];

function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

// üõí 52 Festive Deals Generation
for (let i = 1; i <= 52; i++) {
    const price = Math.floor(Math.random() * 9000) + 499;
    const mrp = price + Math.floor(Math.random() * 4000) + 500;
    
    const randomProduct = trendingProducts[Math.floor(Math.random() * trendingProducts.length)];
    const shuffledPool = shuffle([...imagePool[randomProduct]]);
    const randomImg = shuffledPool[0]; 

    realDealsData.push({
        title: `${randomProduct} - Festive Special!`,
        price: price,
        mrp: mrp,
        savings: `Flat ${Math.round(((mrp - price) / mrp) * 100)}% Off`,
        affiliate_link: `https://www.amazon.in/s?k=${randomProduct.replace(/\s/g, '+')}&tag=${PARTNER_TAG}`,
        image: randomImg
    });
}

const indexPath = path.join(__dirname, 'index.html');
let content = fs.readFileSync(indexPath, 'utf8');

// Update Deals Data
content = content.replace(/(\/\/ --- START: AUTOGENERATED DEALS DATA ---)[\s\S]*?(\/\/ --- END: AUTOGENERATED DEALS DATA ---)/, 
    `$1\nconst dummyDeals = ${JSON.stringify(realDealsData, null, 4)};\n$2`);

// Update Context to Festive
content = content.replace(/(\/\/ --- START: CONTEXT DATA ---)[\s\S]*?(\/\/ --- END: CONTEXT DATA ---)/, 
    `$1\nconst affimaniaContext = ${JSON.stringify(seasonalDatabase.festive)};\n$2`);

fs.writeFileSync(indexPath, content);
console.log('‚úÖ Success: 52 Festive Deals updated with API-Ready Structure!');
